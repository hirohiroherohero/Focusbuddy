---
stepsCompleted: [1, 2, 3, 4, 5, 6]
inputDocuments:
  - "_bmad-output/planning-artifacts/prd.md"
  - "_bmad-output/planning-artifacts/ux-design-specification.md"
  - "_bmad-output/planning-artifacts/product-brief-FocusBuddy-2026-01-07.md"
workflow_completed: true
---

# Architecture Decision Document - FocusBuddy

**Author:** Hiro
**Date:** 2026-01-07
**Version:** 1.0

---

## 1. Executive Summary

FocusBuddyëŠ” macOS ë©”ë‰´ë°” ìƒì£¼ ì•±ìœ¼ë¡œ, Swift/SwiftUI ê¸°ë°˜ì˜ ë„¤ì´í‹°ë¸Œ ì•±ì…ë‹ˆë‹¤. MVVM ì•„í‚¤í…ì²˜ë¥¼ ì‚¬ìš©í•˜ë©°, ëª¨ë“  ë°ì´í„°ëŠ” ë¡œì»¬ì— ì €ì¥ë©ë‹ˆë‹¤. ì™¸ë¶€ ì„œë²„ ì—°ë™ì´ ì—†ëŠ” ì™„ì „ ì˜¤í”„ë¼ì¸ ì•±ì…ë‹ˆë‹¤.

### í•µì‹¬ ì•„í‚¤í…ì²˜ ê²°ì •

| ì˜ì—­ | ê²°ì • | ê·¼ê±° |
|-----|------|------|
| **í”Œë«í¼** | macOS 13.0+ | Ventura ì´ìƒ, SwiftUI ìµœì‹  ê¸°ëŠ¥ |
| **ì–¸ì–´** | Swift 5.9+ | ìµœì‹  Swift, async/await |
| **UI í”„ë ˆì„ì›Œí¬** | SwiftUI | ì„ ì–¸ì  UI, ë©”ë‰´ë°” ì•±ì— ì í•© |
| **ì•„í‚¤í…ì²˜** | MVVM | SwiftUIì™€ ìì—°ìŠ¤ëŸ¬ìš´ ì¡°í•© |
| **ë°ì´í„° ì €ì¥** | UserDefaults + JSON | ê°„ë‹¨, ë¡œì»¬ ì „ìš© |
| **ìƒíƒœ ê´€ë¦¬** | @Observable (Swift 5.9) | ìµœì‹  ë§¤í¬ë¡œ ê¸°ë°˜ |

---

## 2. System Context

### 2.1 ì‹œìŠ¤í…œ ê²½ê³„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    macOS                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              FocusBuddy.app                   â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚ Views   â”‚  â”‚ViewModelsâ”‚  â”‚  Services   â”‚   â”‚  â”‚
â”‚  â”‚  â”‚(SwiftUI)â”‚â—„â”€â”¤ (MVVM)  â”‚â—„â”€â”¤(Data/Timer) â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                    â”‚                          â”‚  â”‚
â”‚  â”‚              â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                   â”‚  â”‚
â”‚  â”‚              â”‚  Models   â”‚                   â”‚  â”‚
â”‚  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                       â”‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           Local Storage                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ UserDefaults â”‚  â”‚ ~/Library/App Supportâ”‚   â”‚   â”‚
â”‚  â”‚  â”‚  (Settings)  â”‚  â”‚   (Session Data)     â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ì™¸ë¶€ ì˜ì¡´ì„±

| ì˜ì¡´ì„± | ìš©ë„ | í•„ìˆ˜ ì—¬ë¶€ |
|-------|------|----------|
| macOS 13.0+ | ìš´ì˜ì²´ì œ | í•„ìˆ˜ |
| UserNotifications | ì‹œìŠ¤í…œ ì•Œë¦¼ | í•„ìˆ˜ |
| ServiceManagement | ë¡œê·¸ì¸ ì‹œ ìë™ ì‹œì‘ | ì„ íƒ |

**ì™¸ë¶€ ì„œë²„/API: ì—†ìŒ** (ì™„ì „ ì˜¤í”„ë¼ì¸)

---

## 3. Architecture Decisions

### ADR-001: SwiftUI + AppKit í•˜ì´ë¸Œë¦¬ë“œ

**ê²°ì •:** SwiftUIë¥¼ ì£¼ë ¥ìœ¼ë¡œ ì‚¬ìš©í•˜ë˜, ë©”ë‰´ë°”(NSStatusItem)ëŠ” AppKit ì‚¬ìš©

**ê·¼ê±°:**
- SwiftUIë§Œìœ¼ë¡œëŠ” ë©”ë‰´ë°” ì•± êµ¬í˜„ ë¶ˆê°€
- NSStatusItem + NSPopoverëŠ” AppKit í•„ìˆ˜
- íŒì˜¤ë²„ ë‚´ë¶€ ì½˜í…ì¸ ëŠ” SwiftUIë¡œ êµ¬í˜„

**êµ¬í˜„:**
```swift
// AppDelegate.swift
class AppDelegate: NSObject, NSApplicationDelegate {
    var statusItem: NSStatusItem?
    var popover: NSPopover?

    func applicationDidFinishLaunching(_ notification: Notification) {
        statusItem = NSStatusBar.system.statusItem(withLength: NSStatusItem.variableLength)
        popover = NSPopover()
        popover?.contentViewController = NSHostingController(rootView: ContentView())
    }
}
```

---

### ADR-002: MVVM ì•„í‚¤í…ì²˜

**ê²°ì •:** Model-View-ViewModel íŒ¨í„´ ì‚¬ìš©

**ê·¼ê±°:**
- SwiftUIì˜ ë°ì´í„° ë°”ì¸ë”©ê³¼ ìì—°ìŠ¤ëŸ½ê²Œ ì—°ë™
- í…ŒìŠ¤íŠ¸ ìš©ì´ì„±
- ê´€ì‹¬ì‚¬ ë¶„ë¦¬

**êµ¬ì¡°:**
```
View (SwiftUI) â”€â”€observeâ”€â”€â–º ViewModel (@Observable) â”€â”€usesâ”€â”€â–º Model + Services
```

---

### ADR-003: @Observable ë§¤í¬ë¡œ (Swift 5.9)

**ê²°ì •:** ObservableObject ëŒ€ì‹  @Observable ë§¤í¬ë¡œ ì‚¬ìš©

**ê·¼ê±°:**
- ìµœì‹  Swift 5.9 ê¸°ëŠ¥
- ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ê°ì†Œ
- ì„±ëŠ¥ í–¥ìƒ (ì„¸ë°€í•œ ì—…ë°ì´íŠ¸)

**ì˜ˆì‹œ:**
```swift
@Observable
class TimerViewModel {
    var remainingSeconds: Int = 25 * 60
    var state: TimerState = .idle
    var currentMessage: String = ""
}
```

---

### ADR-004: ë¡œì»¬ ë°ì´í„° ì €ì¥ ì „ëµ

**ê²°ì •:** UserDefaults (ì„¤ì •) + JSON íŒŒì¼ (ì„¸ì…˜ ê¸°ë¡)

**ê·¼ê±°:**
- ê°„ë‹¨í•œ êµ¬í˜„
- ì™¸ë¶€ ì˜ì¡´ì„± ì—†ìŒ
- ì¶©ë¶„í•œ ì„±ëŠ¥ (ì†ŒëŸ‰ ë°ì´í„°)

**ë°ì´í„° ë¶„ë¥˜:**
| ë°ì´í„° | ì €ì¥ì†Œ | ì´ìœ  |
|-------|--------|-----|
| ì„¤ì • (ìë™ì‹œì‘ ë“±) | UserDefaults | ê°„ë‹¨í•œ key-value |
| ì„¸ì…˜ íˆìŠ¤í† ë¦¬ | JSON íŒŒì¼ | êµ¬ì¡°í™”ëœ ë°ì´í„° |
| ì¹­í˜¸ íšë“ ìƒíƒœ | JSON íŒŒì¼ | ë³µì¡í•œ ìƒíƒœ |
| ì”ë”” ìº˜ë¦°ë” ë°ì´í„° | JSON íŒŒì¼ | ë‚ ì§œë³„ ê¸°ë¡ |

**ì €ì¥ ê²½ë¡œ:**
```
~/Library/Application Support/FocusBuddy/
â”œâ”€â”€ sessions.json       # ì„¸ì…˜ íˆìŠ¤í† ë¦¬
â”œâ”€â”€ titles.json         # ì¹­í˜¸ ìƒíƒœ
â””â”€â”€ calendar.json       # ì”ë”” ë°ì´í„°
```

---

### ADR-005: íƒ€ì´ë¨¸ êµ¬í˜„

**ê²°ì •:** Timer.publish + Combine ì‚¬ìš©

**ê·¼ê±°:**
- SwiftUIì™€ ìì—°ìŠ¤ëŸ¬ìš´ í†µí•©
- ë©”ì¸ ìŠ¤ë ˆë“œì—ì„œ ì•ˆì „í•˜ê²Œ ì‹¤í–‰
- ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬ ë¶ˆí•„ìš” (ë©”ë‰´ë°” ì•±ì€ í•­ìƒ í™œì„±)

**êµ¬í˜„:**
```swift
@Observable
class TimerViewModel {
    private var timerCancellable: AnyCancellable?

    func startFocus() {
        timerCancellable = Timer.publish(every: 1, on: .main, in: .common)
            .autoconnect()
            .sink { [weak self] _ in
                self?.tick()
            }
    }
}
```

---

### ADR-006: ìƒíƒœ ë¨¸ì‹  (Timer State)

**ê²°ì •:** enum ê¸°ë°˜ ìƒíƒœ ë¨¸ì‹ 

**ìƒíƒœ ë‹¤ì´ì–´ê·¸ë¨:**
```
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   idle   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                       â”‚
              â”‚ start()                     â”‚
              â–¼                             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
         â”‚ focusing â”‚â”€â”€â”€â”€ complete() â”€â”€â”€â”€â”€â”€â”€â”¤
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                       â”‚
              â”‚ giveUp()                    â”‚
              â–¼                             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
         â”‚ resting  â”‚â”€â”€â”€â”€ restComplete() â”€â”€â”€â”˜
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**êµ¬í˜„:**
```swift
enum TimerState {
    case idle
    case focusing(remaining: Int)
    case resting(remaining: Int)
}
```

---

## 4. Component Architecture

### 4.1 í”„ë¡œì íŠ¸ êµ¬ì¡°

```
FocusBuddy/
â”œâ”€â”€ FocusBuddyApp.swift           # @main ì§„ì…ì 
â”œâ”€â”€ AppDelegate.swift             # ë©”ë‰´ë°” ì„¤ì • (AppKit)
â”‚
â”œâ”€â”€ Models/
â”‚   â”œâ”€â”€ Session.swift             # ì„¸ì…˜ ê¸°ë¡ ëª¨ë¸
â”‚   â”œâ”€â”€ Title.swift               # ì¹­í˜¸ ëª¨ë¸
â”‚   â”œâ”€â”€ DayRecord.swift           # ì¼ë³„ ê¸°ë¡
â”‚   â””â”€â”€ TimerState.swift          # íƒ€ì´ë¨¸ ìƒíƒœ
â”‚
â”œâ”€â”€ ViewModels/
â”‚   â”œâ”€â”€ TimerViewModel.swift      # íƒ€ì´ë¨¸ ë¡œì§
â”‚   â”œâ”€â”€ CalendarViewModel.swift   # ì”ë”” ìº˜ë¦°ë” ë¡œì§
â”‚   â”œâ”€â”€ TitleViewModel.swift      # ì¹­í˜¸ ë¡œì§
â”‚   â””â”€â”€ SettingsViewModel.swift   # ì„¤ì • ë¡œì§
â”‚
â”œâ”€â”€ Views/
â”‚   â”œâ”€â”€ ContentView.swift         # ë©”ì¸ ì»¨í…Œì´ë„ˆ
â”‚   â”œâ”€â”€ TimerView.swift           # íƒ€ì´ë¨¸ UI
â”‚   â”œâ”€â”€ GrassCalendarView.swift   # ì”ë”” ìº˜ë¦°ë”
â”‚   â”œâ”€â”€ TitleCollectionView.swift # ì¹­í˜¸ ë„ê°
â”‚   â”œâ”€â”€ SettingsView.swift        # ì„¤ì • í™”ë©´
â”‚   â””â”€â”€ Components/
â”‚       â”œâ”€â”€ GrassCell.swift       # ì”ë”” ì…€
â”‚       â”œâ”€â”€ TitleCard.swift       # ì¹­í˜¸ ì¹´ë“œ
â”‚       â””â”€â”€ MessageToast.swift    # ë©”ì‹œì§€ í† ìŠ¤íŠ¸
â”‚
â”œâ”€â”€ Services/
â”‚   â”œâ”€â”€ DataService.swift         # ë°ì´í„° ì €ì¥/ë¡œë“œ
â”‚   â”œâ”€â”€ NotificationService.swift # ì‹œìŠ¤í…œ ì•Œë¦¼
â”‚   â”œâ”€â”€ MessageService.swift      # ê¸ì • ë©”ì‹œì§€ ê´€ë¦¬
â”‚   â””â”€â”€ TitleChecker.swift        # ì¹­í˜¸ ì¡°ê±´ ì²´í¬
â”‚
â””â”€â”€ Resources/
    â”œâ”€â”€ Assets.xcassets           # ì´ë¯¸ì§€/ì•„ì´ì½˜
    â”œâ”€â”€ Localizable.strings       # ë¬¸ìì—´
    â””â”€â”€ Messages.json             # ë©”ì‹œì§€ í’€
```

### 4.2 ì˜ì¡´ì„± ê·¸ë˜í”„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Views                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚TimerView â”‚ â”‚CalendarV â”‚ â”‚ TitleV   â”‚ â”‚SettingsVâ”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜       â”‚
â”‚       â”‚            â”‚            â”‚            â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚            â”‚            â”‚            â”‚
        â–¼            â–¼            â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ViewModels                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚TimerVM   â”‚ â”‚CalendarVMâ”‚ â”‚ TitleVM  â”‚ â”‚SettingsVMâ”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜       â”‚
â”‚       â”‚            â”‚            â”‚            â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚            â”‚            â”‚            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Services                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ DataService â”‚ â”‚MessageService â”‚ â”‚NotificationServiceâ”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Local Storage                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ UserDefaults â”‚  â”‚ ~/Library/Application Support/      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Data Models

### 5.1 Session

```swift
struct Session: Codable, Identifiable {
    let id: UUID
    let startedAt: Date
    let endedAt: Date
    let duration: Int           // ì´ˆ ë‹¨ìœ„
    let completed: Bool         // ì™„ë£Œ vs í¬ê¸°
    let type: SessionType       // focus / rest
}

enum SessionType: String, Codable {
    case focus
    case rest
}
```

### 5.2 Title (ì¹­í˜¸)

```swift
struct Title: Codable, Identifiable {
    let id: String              // "first_focus", "7_day_streak" ë“±
    let name: String            // "ì‹ ì… ì§‘ì¤‘ëŸ¬"
    let icon: String            // "ğŸŒ±"
    let description: String     // "ì²« ì„¸ì…˜ ì™„ë£Œ"
    let condition: TitleCondition
    var unlockedAt: Date?       // nilì´ë©´ ë¯¸íšë“
}

enum TitleCondition: Codable {
    case sessionCount(Int)      // NíšŒ ì„¸ì…˜ ì™„ë£Œ
    case streakDays(Int)        // Nì¼ ì—°ì†
    case timeOfDay(hour: Int, before: Bool)  // íŠ¹ì • ì‹œê°„
    case dayOfWeek([Int])       // íŠ¹ì • ìš”ì¼
    case totalDays(Int)         // ì´ ì‚¬ìš©ì¼
    case afterGiveUp            // í¬ê¸° í›„ ì¬ë„ì „
}
```

### 5.3 DayRecord (ì¼ë³„ ê¸°ë¡)

```swift
struct DayRecord: Codable {
    let date: String            // "2026-01-07"
    var sessionCount: Int       // í•´ë‹¹ ë‚ ì§œ ì„¸ì…˜ ìˆ˜
    var totalMinutes: Int       // í•´ë‹¹ ë‚ ì§œ ì´ ì§‘ì¤‘ ì‹œê°„
}
```

### 5.4 AppSettings

```swift
struct AppSettings: Codable {
    var launchAtLogin: Bool = false
    var focusDuration: Int = 25 * 60    // ì´ˆ
    var restDuration: Int = 5 * 60      // ì´ˆ
    var soundEnabled: Bool = true
    var notificationEnabled: Bool = true
    var representativeTitle: String? = nil
}
```

---

## 6. Key Algorithms

### 6.1 ì”ë”” ìƒ‰ìƒ ê³„ì‚°

```swift
func grassColor(for sessionCount: Int) -> Color {
    switch sessionCount {
    case 0:     return Color(hex: "#EBEDF0")  // ë¹ˆ ì¹¸
    case 1:     return Color(hex: "#9BE9A8")  // ì—°í•œ ì´ˆë¡
    case 2:     return Color(hex: "#40C463")  // ì¤‘ê°„ ì´ˆë¡
    default:    return Color(hex: "#30A14E")  // ì§„í•œ ì´ˆë¡
    }
}
```

### 6.2 ì—°ì† ì§‘ì¤‘ì¼ ê³„ì‚°

```swift
func calculateStreak(records: [DayRecord]) -> Int {
    let sortedDates = records
        .filter { $0.sessionCount > 0 }
        .map { $0.date }
        .sorted(by: >)

    guard let today = sortedDates.first else { return 0 }

    var streak = 1
    var current = today

    for date in sortedDates.dropFirst() {
        if isConsecutive(date, to: current) {
            streak += 1
            current = date
        } else {
            break
        }
    }

    return streak
}
```

### 6.3 ì¹­í˜¸ ì¡°ê±´ ì²´í¬

```swift
func checkTitleConditions(
    session: Session,
    allSessions: [Session],
    streak: Int
) -> [Title] {
    var newTitles: [Title] = []

    for title in allTitles where title.unlockedAt == nil {
        if title.condition.isSatisfied(
            session: session,
            allSessions: allSessions,
            streak: streak
        ) {
            var unlockedTitle = title
            unlockedTitle.unlockedAt = Date()
            newTitles.append(unlockedTitle)
        }
    }

    return newTitles
}
```

---

## 7. Error Handling

### 7.1 ì—ëŸ¬ íƒ€ì…

```swift
enum FocusBuddyError: Error {
    case dataLoadFailed
    case dataSaveFailed
    case invalidData
}
```

### 7.2 ì—ëŸ¬ ì²˜ë¦¬ ì „ëµ

| ì—ëŸ¬ ìƒí™© | ì²˜ë¦¬ ë°©ë²• |
|----------|----------|
| ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨ | ê¸°ë³¸ê°’ ì‚¬ìš©, ë°±ê·¸ë¼ìš´ë“œ ì¬ì‹œë„ |
| ë°ì´í„° ì €ì¥ ì‹¤íŒ¨ | 3íšŒ ì¬ì‹œë„, ì‹¤íŒ¨ ì‹œ ë©”ëª¨ë¦¬ì—ë§Œ ìœ ì§€ |
| ì˜ëª»ëœ ë°ì´í„° | í•´ë‹¹ ë ˆì½”ë“œ ìŠ¤í‚µ, ë¡œê·¸ ê¸°ë¡ |

---

## 8. Performance Considerations

### 8.1 ì„±ëŠ¥ ëª©í‘œ

| í•­ëª© | ëª©í‘œ |
|-----|-----|
| ì•± ì‹œì‘ ì‹œê°„ | < 1ì´ˆ |
| íŒì˜¤ë²„ ì—´ë¦¼ | < 0.3ì´ˆ |
| ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ | < 50MB |
| CPU (ìœ íœ´) | < 1% |
| íƒ€ì´ë¨¸ ì •í™•ë„ | Â±1ì´ˆ |

### 8.2 ìµœì í™” ì „ëµ

1. **Lazy Loading:** ì¹­í˜¸ ë„ê°, ì”ë”” ìº˜ë¦°ë”ëŠ” íƒ­ ì „í™˜ ì‹œ ë¡œë“œ
2. **ìºì‹±:** ì—°ì†ì¼ ê³„ì‚° ê²°ê³¼ ìºì‹±
3. **ë°°ì¹˜ ì €ì¥:** ì„¸ì…˜ ë°ì´í„°ëŠ” ì„¸ì…˜ ì¢…ë£Œ ì‹œì—ë§Œ ì €ì¥

---

## 9. Security & Privacy

### 9.1 í”„ë¼ì´ë²„ì‹œ ì›ì¹™

- **ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì—†ìŒ:** ì™„ì „ ì˜¤í”„ë¼ì¸
- **ê°œì¸ì •ë³´ ìˆ˜ì§‘ ì—†ìŒ:** ë¶„ì„/ì¶”ì  ì—†ìŒ
- **ë¡œì»¬ ì „ìš© ë°ì´í„°:** ëª¨ë“  ë°ì´í„°ëŠ” ì‚¬ìš©ì Macì—ë§Œ ì €ì¥

### 9.2 ë°ì´í„° ë³´ì•ˆ

| ë°ì´í„° | ë³´í˜¸ ë°©ë²• |
|-------|----------|
| ì„¸ì…˜ ê¸°ë¡ | ë¡œì»¬ íŒŒì¼, ì‹œìŠ¤í…œ ê¶Œí•œìœ¼ë¡œ ë³´í˜¸ |
| ì„¤ì • | UserDefaults (ì•± ìƒŒë“œë°•ìŠ¤) |

---

## 10. Testing Strategy

### 10.1 í…ŒìŠ¤íŠ¸ ë ˆë²¨

| ë ˆë²¨ | ëŒ€ìƒ | ë„êµ¬ |
|-----|------|-----|
| Unit | ViewModels, Services | XCTest |
| UI | Views, ì¸í„°ë™ì…˜ | XCUITest |
| Manual | ì „ì²´ í”Œë¡œìš° | ìˆ˜ë™ í…ŒìŠ¤íŠ¸ |

### 10.2 í•µì‹¬ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤

1. íƒ€ì´ë¨¸ ì‹œì‘/ì™„ë£Œ/í¬ê¸° í”Œë¡œìš°
2. ì”ë”” ìº˜ë¦°ë” ìƒ‰ìƒ ì •í™•ì„±
3. ì¹­í˜¸ ì¡°ê±´ ì²´í¬ ì •í™•ì„±
4. ë°ì´í„° ì €ì¥/ë¡œë“œ ì •ìƒ ë™ì‘
5. ìì • ë„˜ê¹€ ì‹œ ë‚ ì§œ ì²˜ë¦¬

---

## 11. Build & Distribution

### 11.1 ë¹Œë“œ ì„¤ì •

- **Xcode:** 15.0+
- **Swift:** 5.9+
- **Target:** macOS 13.0+
- **Architecture:** Universal (Apple Silicon + Intel)

### 11.2 ë°°í¬ ë°©ë²•

**ì¹œêµ¬ ë°°í¬ (ì‚¬ì´ë“œ í”„ë¡œì íŠ¸):**
```bash
# 1. Archive
xcodebuild archive -scheme FocusBuddy -archivePath build/FocusBuddy.xcarchive

# 2. Export (Developer ID ë˜ëŠ” ad-hoc)
xcodebuild -exportArchive -archivePath build/FocusBuddy.xcarchive \
  -exportPath build/ -exportOptionsPlist ExportOptions.plist

# 3. ê²°ê³¼ë¬¼
build/FocusBuddy.app  # â†’ ì¹œêµ¬ì—ê²Œ ì „ë‹¬
```

---

## 12. Development Guidelines

### 12.1 ì½”ë”© ì»¨ë²¤ì…˜

- **ë„¤ì´ë°:** Swift API Design Guidelines ì¤€ìˆ˜
- **í¬ë§·íŒ…:** SwiftFormat ì‚¬ìš©
- **ì£¼ì„:** ë³µì¡í•œ ë¡œì§ì—ë§Œ, ì½”ë“œë¡œ ì„¤ëª… ìš°ì„ 

### 12.2 Git ë¸Œëœì¹˜ ì „ëµ

```
main â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
  â”‚
  â””â”€â”€ feature/timer â”€â”€â–º merge
  â””â”€â”€ feature/calendar â”€â”€â–º merge
  â””â”€â”€ feature/titles â”€â”€â–º merge
```

### 12.3 AI ì—ì´ì „íŠ¸ ê°€ì´ë“œë¼ì¸

**AI ì—ì´ì „íŠ¸ê°€ ì½”ë“œ ìƒì„± ì‹œ ì¤€ìˆ˜í•  ê·œì¹™:**

1. **MVVM íŒ¨í„´ ìœ ì§€:** Viewì— ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë„£ì§€ ì•Šê¸°
2. **@Observable ì‚¬ìš©:** ObservableObject ëŒ€ì‹ 
3. **Services í†µí•´ ë°ì´í„° ì ‘ê·¼:** ViewModelì—ì„œ ì§ì ‘ íŒŒì¼ ì ‘ê·¼ ê¸ˆì§€
4. **í•œê¸€ ë©”ì‹œì§€:** UI í…ìŠ¤íŠ¸ëŠ” ëª¨ë‘ í•œê¸€
5. **ê¸ì •ì  í†¤:** ëª¨ë“  ë©”ì‹œì§€ëŠ” ì‘ì›í•˜ëŠ” í†¤

---

## Document History

| ë²„ì „ | ë‚ ì§œ | ì‘ì„±ì | ë³€ê²½ì‚¬í•­ |
|-----|------|-------|---------|
| 1.0 | 2026-01-07 | Hiro | ì´ˆê¸° ì•„í‚¤í…ì²˜ ì„¤ê³„ |

---

**Architecture Document ì™„ë£Œ** âœ…
